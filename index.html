<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dividend Discount Model Calculator - CFA Institute</title>
  <link rel="stylesheet" href="cfa-base.css">
  <link rel="stylesheet" href="dividend-specific.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>

  <!-- SKIP LINKS -->
  <nav aria-label="Skip links" class="skip-links-nav">
    <a href="#data-entry" class="skip-link">Skip to calculator</a>
    <a href="#visualization-card" class="skip-link">Skip to visualization</a>
    <a href="#view-table-btn" class="skip-link" id="skip-to-table">Skip to data table</a>
  </nav>

  <!-- NOSCRIPT FALLBACK -->
  <noscript>
    <div class="card" style="margin:2rem auto;max-width:600px;">
      <h4 style="font-family:Georgia,serif;color:var(--color-primary-dark-blue);">Dividend Discount Model Calculator</h4>
      <p><strong>JavaScript is required</strong> for the interactive version.</p>
    </div>
  </noscript>

  <div class="container">
    <main class="content">
      <!-- CARD 1 - Equation -->
      <section class="card" id="equation-card">
        <h4 class="card-title">Equity Cash Flow Equations</h4>
        <p class="equation-intro">These dynamic equations display the present value of a stock as well as the expected future dividend payments based upon your inputs for each dividend model.</p>

        <div class="model-equations-grid">
          <!-- Constant Dividend Model -->
          <div class="formula-box constant">
            <div class="formula-box-title">Constant Dividend</div>
            <div class="equation-container" tabindex="0" role="math"
                 aria-label="Present value at time t equals Div t plus 1 divided by r">
              <div class="mathml-equation">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <msub>
                      <mi mathcolor="#3c6ae5" mathvariant="bold">PV</mi>
                      <mi>t</mi>
                    </msub>
                    <mo>=</mo>
                    <mfrac>
                      <msub>
                        <mi mathcolor="#b95b1d">Div</mi>
                        <mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow>
                      </msub>
                      <mi mathcolor="#733599">r</mi>
                    </mfrac>
                  </mrow>
                </math>
              </div>
              <div class="html-equation" hidden>
                <strong style="color:#3c6ae5;">PV<sub>t</sub></strong> = 
                <span style="color:#b95b1d;">Div<sub>t+1</sub></span> ÷ 
                <span style="color:#733599;">r</span>
              </div>
            </div>
          </div>

          <div class="formula-box growth">
            <div class="formula-box-title">Constant Growth</div>
            <div class="equation-container" tabindex="0" role="math"
                 aria-label="Present value at time t equals Div t times 1 plus g divided by r minus g">
              <div class="mathml-equation">
                <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
                  <mrow>
                    <msub>
                      <mi mathcolor="#15803d" mathvariant="bold">PV</mi>
                      <mi>t</mi>
                    </msub>
                    <mo>=</mo>
                    <mfrac>
                      <mrow>
                        <msub><mi mathcolor="#b95b1d">Div</mi><mi>t</mi></msub>
                        <mo>(</mo><mn>1</mn><mo>+</mo><mi mathcolor="#15803d">g</mi><mo>)</mo>
                      </mrow>
                      <mrow>
                        <mi mathcolor="#733599">r</mi>
                        <mo>−</mo>
                        <mi mathcolor="#15803d">g</mi>
                      </mrow>
                    </mfrac>
                    <mo>=</mo>
                    <mfrac>
                      <msub><mi mathcolor="#b95b1d">Div</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub>
                      <mrow>
                        <mi mathcolor="#733599">r</mi>
                        <mo>−</mo>
                        <mi mathcolor="#15803d">g</mi>
                      </mrow>
                    </mfrac>
                  </mrow>
                </math>
              </div>
              <div class="html-equation" hidden>
                <strong style="color:#15803d;">PV<sub>t</sub></strong> = 
                <span style="color:#b95b1d;">Div<sub>t</sub>(1+g)</span> ÷ 
                (<span style="color:#733599;">r</span> − <span style="color:#15803d;">g</span>) = 
                <span style="color:#b95b1d;">Div<sub>t+1</sub></span> ÷ 
                (<span style="color:#733599;">r</span> − <span style="color:#15803d;">g</span>)
              </div>
            </div>
          </div>

          <div class="formula-box changing">
            <div class="formula-box-title">Changing Growth</div>
            <div class="equation-container" tabindex="0" role="math"
                 aria-label="Two-stage model with i and j summation variables">
              <div class="mathml-equation">
                <div class="changing-equation-wrapper">
                  <div class="changing-equation-scroll" tabindex="0" role="region" aria-label="Scrollable changing growth equation">
                    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block" style="font-size:1.15em;">
                      <mrow>
                        <msub>
                          <mi mathcolor="#7a46ff" mathvariant="bold">PV</mi>
                          <mn>0</mn>
                        </msub>
                        <mo>=</mo>
                        <munderover>
                          <mo>∑</mo>
                          <mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow>
                          <mi mathcolor="#0079a6">n</mi>
                        </munderover>
                        <mfrac linethickness="1px">
                          <mrow>
                            <msub>
                              <mi mathcolor="#b95b1d">Div</mi>
                              <mi>t</mi>
                            </msub>
                            <msup>
                              <mrow><mo>(</mo><mn>1</mn><mo>+</mo><msub><mi mathcolor="#15803d">g</mi><mi mathcolor="#15803d">s</mi></msub><mo>)</mo></mrow>
                              <mi>i</mi>
                            </msup>
                          </mrow>
                          <msup>
                            <mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi mathcolor="#733599">r</mi><mo>)</mo></mrow>
                            <mi>i</mi>
                          </msup>
                        </mfrac>
                        <mo>+</mo>
                        <munderover>
                          <mo>∑</mo>
                          <mrow><mi>j</mi><mo>=</mo><mrow><mi mathcolor="#0079a6">n</mi><mo>+</mo><mn>1</mn></mrow></mrow>
                          <mo>∞</mo>
                        </munderover>
                        <mfrac linethickness="1px">
                          <mrow>
                            <msub>
                              <mi mathcolor="#b95b1d">Div</mi>
                              <mrow><mi>t</mi><mo>+</mo><mi>n</mi></mrow>
                            </msub>
                            <msup>
                              <mrow><mo>(</mo><mn>1</mn><mo>+</mo><msub><mi mathcolor="#15803d">g</mi><mi mathcolor="#15803d">l</mi></msub><mo>)</mo></mrow>
                              <mi>j</mi>
                            </msup>
                          </mrow>
                          <msup>
                            <mrow><mo>(</mo><mn>1</mn><mo>+</mo><mi mathcolor="#733599">r</mi><mo>)</mo></mrow>
                            <mi>j</mi>
                          </msup>
                        </mfrac>
                      </mrow>
                    </math>
                  </div>
                </div>
              </div>
              <div class="html-equation" hidden>
                <strong style="color:#7a46ff;">PV<sub>0</sub></strong> = Σ[i=1 to n] Div<sub>t</sub>(1+g<sub>s</sub>)<sup>i</sup>÷(1+r)<sup>i</sup> + Σ[j=n+1 to ∞] Div<sub>t+n</sub>(1+g<sub>l</sub>)<sup>j</sup>÷(1+r)<sup>j</sup>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- CARD 2 - Data Entry (Calculator) - Made Sticky -->
      <section class="card" id="data-entry" tabindex="-1" role="region" aria-labelledby="inputs-title">
        <h4 class="card-title" id="inputs-title">Equity Cash Flow Calculator</h4>

        <!-- Model Selector -->
        <fieldset class="model-controls">
          <legend class="model-selector-label">Select model:</legend>
          <button id="model-all-btn" class="model-btn active" data-model="all" aria-pressed="true">All Models</button>
          <button id="model-constant-btn" class="model-btn" data-model="constant" aria-pressed="false">Constant Dividend</button>
          <button id="model-growth-btn" class="model-btn" data-model="growth" aria-pressed="false">Constant Growth</button>
          <button id="model-changing-btn" class="model-btn" data-model="changing" aria-pressed="false">Changing Growth</button>
        </fieldset>

  <!-- Input Grid -->
  <div class="input-grid">
    <!-- Current Dividend -->
     <div class="input-row" data-models="constant growth changing">
  <label for="D0">Current Dividend (<span style="color: #b95b1d; font-style: italic;">Div<sub style="color: #000000;">t</sub></span>):</label>
  <div class="input-wrapper">
    <span class="input-prefix">USD</span>
    <input type="number" id="D0" class="input-field-inline" min="0.01" max="1000" step="0.01" value="5"
           aria-required="true" aria-describedby="D0-help">
    <span id="D0-help" class="sr-only">The most recent annual dividend paid by the company</span>
  </div>
</div>


    <!-- Required Return -->
    <div class="input-row" data-models="constant growth changing">
      <label for="required">Required Return (<span style="color: #733599; font-style: italic;">r</span>):</label>
      <div class="input-wrapper suffix">
        <input
          type="number"
          id="required"
          class="input-field-inline"
          min="0.1"
          max="50"
          step="0.1"
          value="10"
          aria-required="true"
          aria-describedby="required-help"
        >
        <span class="input-suffix">%</span>
        <span id="required-help" class="sr-only">The minimum annual return investors expect from this stock</span>
      </div>
    </div>

    <!-- Constant Growth -->
    <div class="input-row" data-models="growth">
      <label for="gConst">Constant Growth (<span style="color: #15803d; font-style: italic;">g</span>):</label>
      <div class="input-wrapper suffix">
        <input
          type="number"
          id="gConst"
          class="input-field-inline"
          min="-10"
          max="30"
          step="0.1"
          value="5"
          aria-required="true"
          aria-describedby="gConst-help"
        >
        <span class="input-suffix">%</span>
        <span id="gConst-help" class="sr-only">Expected annual dividend growth rate for the Gordon Growth Model</span>
      </div>
    </div>

    <!-- Short-Term Growth -->
    <div class="input-row" data-models="changing">
      <label for="gShort">Short-Term Growth (<span style="color: #15803d; font-style: italic;">g<sub>s</sub></span>):</label>
      <div class="input-wrapper suffix">
        <input
          type="number"
          id="gShort"
          class="input-field-inline"
          min="-10"
          max="50"
          step="0.1"
          value="8"
          aria-required="true"
          aria-describedby="gShort-help"
        >
        <span class="input-suffix">%</span>
        <span id="gShort-help" class="sr-only">High growth rate during the initial growth phase</span>
      </div>
    </div>

    <!-- Long-Term Growth -->
    <div class="input-row" data-models="changing">
      <label for="gLong">Long-Term Growth (<span style="color: #15803d; font-style: italic;">g<sub>l</sub></span>):</label>
      <div class="input-wrapper suffix">
        <input
          type="number"
          id="gLong"
          class="input-field-inline"
          min="-10"
          max="30"
          step="0.1"
          value="3"
          aria-required="true"
          aria-describedby="gLong-help"
        >
        <span class="input-suffix">%</span>
        <span id="gLong-help" class="sr-only">Sustainable growth rate after the high growth phase ends</span>
      </div>
    </div>

    <!-- High-Growth Period -->
    <div class="input-row" data-models="changing">
      <label for="shortYears">High-Growth Period (<span style="color: #0079a6; font-style: italic;">n</span>):</label>
      <div class="input-wrapper suffix">
        <input
          type="number"
          id="shortYears"
          class="input-field-inline"
          min="1"
          max="10"
          step="1"
          value="5"
          aria-required="true"
          aria-describedby="shortYears-help"
        >
        <span class="input-suffix">years</span>
        <span id="shortYears-help" class="sr-only">Number of years the company will grow at the high rate</span>
      </div>
    </div>
  </div>

  <!-- Validation Summary -->
  <div id="validation-summary" class="validation-summary" role="alert" aria-live="polite" style="display:none;">
    <div class="validation-title">Please correct the following:</div>
    <ul id="validation-list"></ul>
  </div>
</section>

      <!-- Calculation announcement for screen readers -->
      <div id="calculation-announcement" class="sr-only" aria-live="polite" aria-atomic="true"></div>

      <!-- CARD 3 - Visualization (Chart/Table) -->
      <section class="card" id="visualization-card" tabindex="-1" aria-labelledby="visualization-title">
        <h4 class="card-title" id="visualization-title">Equity Cash Flows</h4>
        
        <!-- View Toggle -->
        <div class="view-controls">
          <div class="legend" id="chart-legend" role="list" aria-label="Chart legend">
            <!-- Legend populated by JavaScript -->
          </div>
          
          <div class="button-group" role="group" aria-label="View mode - switch between chart and table">
            <button id="view-chart-btn" class="toggle-btn active" aria-pressed="true" title="If Chart is unavailable, zoom out in your browser window.">Chart</button>
            <button id="view-table-btn" class="toggle-btn" aria-pressed="false">Table</button>
          </div>
        </div>

        <div id="chart-container" class="chart-wrapper">
          <canvas id="chart" tabindex="0" role="img" aria-label="Bar chart showing dividend cash flows"></canvas>
          <div id="chart-announcement" class="sr-only" aria-live="polite" aria-atomic="true"></div>
        </div>

        <div id="table-container" class="table-scroll-wrapper table-card-layout" style="display:none;">
          <table id="data-table" class="data-table" tabindex="0" role="region" aria-label="Dividend cash flow data table">
            <!-- Table content populated by table.js -->
          </table>
        </div>
      </section>

    </main>
  </div>

  <script type="module" src="./calculator.js"></script>
  <script type="module" src="./modules/sticky-calculator.js"></script>
  <script type="module" src="./modules/iframe-resize.js"></script>
  <script type="module">
    if (!CSS.supports('math-style: normal')) {
      document.querySelectorAll('.mathml-equation').forEach(el => el.hidden = true);
      document.querySelectorAll('.html-equation').forEach(el => el.hidden = false);
    }
  </script>
</body>
</html>